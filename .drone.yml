build:
  test:
    image: golang:1.8.1-alpine
    environment:
      ENV: CI
    commands:
      - echo "this is a go app  "
    when:
      event:
        - push

# publish:
#   gcr:
#     context: nginx
#     debug: true
#     file: nginx/Dockerfile
#     registry: us.gcr.io
#     repo: inspiring-cat-165403/nginx
#     tag:
#       - latest
#       - $$COMMIT
#     token: >
#       $$GOOGLE_CREDENTIALS
#     when:
#       event: push
deploy:
  gke:
    environment:
      DOCKER_LAUNCH_DEBUG: true
    image: us.gcr.io/inspiring-cat-165403/nginx
    debug: true
    namespace: $$BRANCH
    token: >
      $$GOOGLE_CREDENTIALS
